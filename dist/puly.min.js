/*!
 * puly - 基于Image3D.js开发，底层依赖webgl实现，通过配置和简单的方法调用，可以快速实现三维数据可视化和VR效果等。
 * git+https://github.com/hai2007/puly.git
 *
 * author 你好2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.1.1
 *
 * Copyright (c) 2021-2022 hai2007 走一步，再走一步。
 * Released under the MIT license
 *
 * Date:Thu Feb 10 2022 11:16:12 GMT+0800 (GMT+08:00)
 */
(function(){"use strict";function e(t){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){e=function(t){return typeof t}}else{e=function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return e(t)}function o(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(t,n.key,n)}}function t(t,e,r){if(e)n(t.prototype,e);if(r)n(t,r);return t}function i(t,e,r){if(e in t){Object.defineProperty(t,e,{value:r,enumerable:true,configurable:true,writable:true})}else{t[e]=r}return t}function s(t){return r(t)||a(t)||f(t)||c()}function r(t){if(Array.isArray(t))return u(t)}function a(t){if(typeof Symbol!=="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function f(t,e){if(!t)return;if(typeof t==="string")return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor)r=t.constructor.name;if(r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}function u(t,e){if(e==null||e>t.length)e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t,e){var r=typeof Symbol!=="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=f(t))||e&&t&&typeof t.length==="number"){if(r)t=r;var n=0;var o=function(){};return{s:o,n:function(){if(n>=t.length)return{done:true};return{done:false,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i=true,a=false,u;return{s:function(){r=r.call(t)},n:function(){var t=r.next();i=t.done;return t},e:function(t){a=true;u=t},f:function(){try{if(!i&&r.return!=null)r.return()}finally{if(a)throw u}}}}function m(t,e){return e={exports:{}},t(e,e.exports),e.exports}var v=m(function(r){var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){var u=function t(e,r,n){var o=e.createShader(r);if(o==null)throw new Error("Unable to create shader!");e.shaderSource(o,n);e.compileShader(o);if(!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Error("Failed to compile shader:"+e.getShaderInfoLog(o));return o};var i=function t(e,r,n){var o=u(e,e.VERTEX_SHADER,r),i=u(e,e.FRAGMENT_SHADER,n);var a=e.createProgram();e.attachShader(a,o);e.attachShader(a,i);e.linkProgram(a);if(!e.getProgramParameter(a,e.LINK_STATUS))throw new Error("Failed to link program: "+e.getProgramInfoLog(a));e.useProgram(a);return a};var a=function t(e,r){var n=e.createBuffer(),o=r?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;e.bindBuffer(o,n);return n};var l=function t(e,r,n,o){var i=o?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;e.bufferData(i,r,n)};var m=function t(e,r,n,o,i,a,u){e.vertexAttribPointer(r,n,o,u||false,i||0,a||0);e.enableVertexAttribArray(r)};var s=function t(e,r,n,o){var i=e.createTexture();if(o=="2d"){n=n||0;e.activeTexture(e["TEXTURE"+n])}e.bindTexture(r,i);return i};var v=function t(e,r,n,o,i,a){o={rgb:e.RGB,rgba:e.RGBA,alpha:e.ALPHA}[o]||e.RGBA;e.texImage2D(r,n||0,o,o,{}[i]||e.UNSIGNED_BYTE,a)};var p=function t(e,r,n,o,i,a,u,f,s){o={rgb:e.RGB,rgba:e.RGBA,alpha:e.ALPHA}[o]||e.RGBA;n=n||0;i={}[i]||e.UNSIGNED_BYTE;var c=[e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Z],l=void 0,m=void 0;for(l=0;l<c.length;l++){m=c[l];e.texImage2D(m,n,o,u,f,0,o,i,null);e.bindTexture(r,s);e.texImage2D(m,n,o,o,i,a[l])}e.generateMipmap(r)};function f(u){return{setAttribute1f:function t(e,r){var n=u.getAttribLocation(u.program,e);u.vertexAttrib1f(n,r)},setAttribute2f:function t(e,r,n){var o=u.getAttribLocation(u.program,e);u.vertexAttrib2f(o,r,n)},setAttribute3f:function t(e,r,n,o){var i=u.getAttribLocation(u.program,e);u.vertexAttrib3f(i,r,n,o)},setAttribute4f:function t(e,r,n,o,i){var a=u.getAttribLocation(u.program,e);u.vertexAttrib4f(a,r,n,o,i)},setAttribute1i:function t(e,r){var n=u.getAttribLocation(u.program,e);u.vertexAttrib1i(n,r)},setAttribute2i:function t(e,r,n){var o=u.getAttribLocation(u.program,e);u.vertexAttrib2i(o,r,n)},setAttribute3i:function t(e,r,n,o){var i=u.getAttribLocation(u.program,e);u.vertexAttrib3i(i,r,n,o)},setAttribute4i:function t(e,r,n,o,i){var a=u.getAttribLocation(u.program,e);u.vertexAttrib4i(a,r,n,o,i)},setUniform1f:function t(e,r){var n=u.getUniformLocation(u.program,e);u.uniform1f(n,r)},setUniform2f:function t(e,r,n){var o=u.getUniformLocation(u.program,e);u.uniform2f(o,r,n)},setUniform3f:function t(e,r,n,o){var i=u.getUniformLocation(u.program,e);u.uniform3f(i,r,n,o)},setUniform4f:function t(e,r,n,o,i){var a=u.getUniformLocation(u.program,e);u.uniform4f(a,r,n,o,i)},setUniform1i:function t(e,r){var n=u.getUniformLocation(u.program,e);u.uniform1i(n,r)},setUniform2i:function t(e,r,n){var o=u.getUniformLocation(u.program,e);u.uniform2i(o,r,n)},setUniform3i:function t(e,r,n,o){var i=u.getUniformLocation(u.program,e);u.uniform3i(i,r,n,o)},setUniform4i:function t(e,r,n,o,i){var a=u.getUniformLocation(u.program,e);u.uniform4i(a,r,n,o,i)},setUniformMatrix2fv:function t(e,r){var n=u.getUniformLocation(u.program,e);u.uniformMatrix2fv(n,false,r)},setUniformMatrix3fv:function t(e,r){var n=u.getUniformLocation(u.program,e);u.uniformMatrix3fv(n,false,r)},setUniformMatrix4fv:function t(e,r){var n=u.getUniformLocation(u.program,e);u.uniformMatrix4fv(n,false,r)}}}function d(o){var i={byte:o.UNSIGNED_BYTE,short:o.UNSIGNED_SHORT};return{openDeep:function t(){o.enable(o.DEPTH_TEST);return this},points:function t(e,r,n){if(n){o.drawElements(o.POINTS,r,i[n],e)}else{o.drawArrays(o.POINTS,e,r)}return this},lines:function t(e,r,n){if(n){o.drawElements(o.LINES,r,i[n],e)}else{o.drawArrays(o.LINES,e,r)}return this},stripLines:function t(e,r,n){if(n){o.drawElements(o.LINE_STRIP,r,i[n],e)}else{o.drawArrays(o.LINE_STRIP,e,r)}return this},loopLines:function t(e,r,n){if(n){o.drawElements(o.LINE_LOOP,r,i[n],e)}else{o.drawArrays(o.LINE_LOOP,e,r)}return this},triangles:function t(e,r,n){if(n){o.drawElements(o.TRIANGLES,r,i[n],e)}else{o.drawArrays(o.TRIANGLES,e,r)}return this},stripTriangles:function t(e,r,n){if(n){o.drawElements(o.TRIANGLE_STRIP,r,i[n],e)}else{o.drawArrays(o.TRIANGLE_STRIP,e,r)}return this},fanTriangles:function t(e,r,n){if(n){o.drawElements(o.TRIANGLE_FAN,r,i[n],e)}else{o.drawArrays(o.TRIANGLE_FAN,e,r)}return this}}}var h=function t(e,r){var n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],o=null,i=void 0;for(i=0;i<n.length;i++){try{o=e.getContext(n[i],r)}catch(t){}if(o)break}if(!o)throw new Error("Non canvas or browser does not support webgl.");return o};function t(t,e){var c=h(t,e),n={_gl_:c,painter:function t(){return d(c)},shader:function t(e,r){c.program=i(c,e,r);return n},buffer:function t(n){a(c,n);var f=void 0,s={write:function t(e,r){r=r||c.STATIC_DRAW;l(c,e,r,n);f=e;return s},use:function t(e,r,n,o,i,a){var u=f.BYTES_PER_ELEMENT;if(typeof e=="string")e=c.getAttribLocation(c.program,e);n=n||0;o=o||0;i=i||c.FLOAT;m(c,e,r,i,n*u,o*u,a);return s}};return s},texture:function u(t,e){var f={"2d":c.TEXTURE_2D,cube:c.TEXTURE_CUBE_MAP}[t];var u=s(c,f,e,t);c.texParameteri(f,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(f,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(f,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);var i={useImage:function t(e,r,n,o){v(c,f,r,n,o,e);return i},useCube:function t(e,r,n,o,i,a){p(c,f,o,i,a,e,r,n,u)}};return i}};var r=f(c);for(var o in r){n[o]=r[o]}c.viewport(0,0,c.canvas.width,c.canvas.height);return n}if(n(r)==="object"&&n(r.exports)==="object"){r.exports=t}else{var e=window.image3DCore;image3D.noConflict=function(){if(window.image3DCore===t){window.image3DCore=e}return t};window.image3DCore=t}})()});function p(t,e,r,n){n=n||0;var o=Math.sqrt(e*e+r*r+n*n);return[1,0,0,0,0,1,0,0,0,0,1,0,e*t/o,r*t/o,n*t/o,1]}function d(t){var e=Math.sin(t),r=Math.cos(t);return[r,e,0,0,-e,r,0,0,0,0,1,0,0,0,0,1]}function h(t,e,r,n,o,i){n=n||0;o=o||0;i=i||0;return[t,0,0,0,0,e,0,0,0,0,r,0,n-n*t,o-o*e,i-i*r,1]}function g(t,e,r,n,o,i){if(typeof t==="number"&&typeof e==="number"){if(typeof r!=="number"){r=0;n=t;o=e;i=1}else if(typeof n!=="number"||typeof o!=="number"||typeof i!=="number"){n=t;o=e;i=r;t=0;e=0;r=0}if(t==n&&e==o&&r==i)throw new Error("It's not a legitimate ray!");var a=Math.sqrt((n-t)*(n-t)+(o-e)*(o-e)),u=a!=0?(o-e)/a:1,f=a!=0?(n-t)/a:0,s=(n-t)*f+(o-e)*u,c=i-r,l=Math.sqrt(s*s+c*c),m=l!=0?c/l:1,v=l!=0?s/l:0;return[[u,m*f,f*v,0,-f,u*m,u*v,0,0,-v,m,0,e*f-t*u,r*v-t*f*m-e*u*m,-t*f*v-e*u*v-r*m,1],[u,-f,0,0,m*f,m*u,-v,0,f*v,u*v,m,0,t,e,r,1]]}else{throw new Error("a1 and b1 is required!")}}var y=function(t,e){var r=[];for(var n=0;n<4;n++)for(var o=0;o<e.length/4;o++)r[o*4+n]=t[n]*e[o*4]+t[n+4]*e[o*4+1]+t[n+8]*e[o*4+2]+t[n+12]*e[o*4+3];return r};function b(t){var f=t||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var s={move:function(t,e,r,n){f=y(p(t,e,r,n),f);return s},rotate:function(t,e,r,n,o,i,a){var u=g(e,r,n,o,i,a);f=y(y(y(u[1],d(t)),u[0]),f);return s},scale:function(t,e,r,n,o,i){f=y(h(t,e,r,n,o,i),f);return s},multiply:function(t,e){f=e?y(f,t):y(t,f);return s},use:function(t,e,r,n){r=r||0;n=n||1;var o=y(f,[t,e,r,n]);o[0]=+o[0].toFixed(7);o[1]=+o[1].toFixed(7);o[2]=+o[2].toFixed(7);o[3]=+o[3].toFixed(7);return o},value:function(){return f}};return s}var E={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var _={stopPropagation:function(t){t=t||window.event;if(t.stopPropagation){t.stopPropagation()}else{t.cancelBubble=true}},preventDefault:function(t){t=t||window.event;if(t.preventDefault){t.preventDefault()}else{t.returnValue=false}},isNode:function(t){return t&&(t.nodeType===1||t.nodeType===9||t.nodeType===11)},bind:function(t,e,r){if(t.constructor===Array||t.constructor===NodeList||t.constructor===HTMLCollection){for(var n=0;n<t.length;n++){this.bind(t[n],e,r)}return}if(window.attachEvent)t.attachEvent("on"+e,r);else t.addEventListener(e,r,false)},unbind:function(t,e,r){if(t.constructor===Array||t.constructor===NodeList||t.constructor===HTMLCollection){for(var n=0;n<t.length;n++){this.unbind(t[n],e,r)}return}if(window.detachEvent)t.detachEvent("on"+e,r);else t.removeEventListener(e,r,false)},find:function(t,e,r){if(!this.isNode(t))return[];var n=t.getElementsByTagName(r||"*");var o=[];for(var i=0;i<n.length;i++){if(this.isNode(n[i])&&(typeof e!="function"||e(n[i])))o.push(n[i])}return o},children:function(t,e){var r=t.childNodes;var n=[];for(var o=0;o<r.length;o++){if(this.isNode(r[o])&&(typeof e!="function"||e(r[o])))n.push(r[o])}return n},hasClass:function(t,e,r){if(e.constructor!==Array)e=[e];var n=" "+(t.getAttribute("class")||"")+" ";for(var o=0;o<e.length;o++){if(n.indexOf(" "+e[o]+" ")>=0){if(r)return true}else{if(!r)return false}}return true},removeClass:function(t,e){var r=" "+(t.getAttribute("class")||"")+" ";var n=r.replace(" "+e.trim()+" "," ");t.setAttribute("class",n.trim())},addClass:function(t,e){if(this.hasClass(t,e))return;var r=t.getAttribute("class")||"";t.setAttribute("class",r+" "+e)},toNode:function(t,e){var r;if(e)r=document.createElementNS(E.svg,"svg");else{var n="div";if(/^<tr[> ]/.test(t)){n="tbody"}else if(/^<th[> ]/.test(t)||/^<td[> ]/.test(t)){n="tr"}else if(/^<thead[> ]/.test(t)||/^<tbody[> ]/.test(t)){n="table"}r=document.createElement(n)}r.innerHTML=t;var o=r.childNodes;for(var i=0;i<o.length;i++){if(this.isNode(o[i]))return o[i]}},trigger:function(t,e){if(document.createEventObject){t.fireEvent("on"+e,document.createEventObject())}else{var r=document.createEvent("HTMLEvents");r.initEvent(e,true,false);t.dispatchEvent(r)}},getStyle:function(t,e){var r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t,null):t.currentStyle;return typeof e==="string"?r.getPropertyValue(e):r},offsetPosition:function(t){var e=0;var r=0;r=t.offsetTop;e=t.offsetLeft;t=t.offsetParent;while(t){r+=t.offsetTop;e+=t.offsetLeft;t=t.offsetParent}return{left:e,top:r}},mousePosition:function(t,e){var r=t.getBoundingClientRect();if(!e||!e.clientX)throw new Error("Event is necessary!");return{x:e.clientX-r.left,y:e.clientY-r.top}},remove:function(t){t.parentNode.removeChild(t)},setStyles:function(t,e){for(var r in e)t.style[r]=e[r]},size:function(t,e){var r,n;if(e=="content"){n=t.clientWidth-(this.getStyle(t,"padding-left")+"").replace("px","")-(this.getStyle(t,"padding-right")+"").replace("px","");r=t.clientHeight-(this.getStyle(t,"padding-top")+"").replace("px","")-(this.getStyle(t,"padding-bottom")+"").replace("px","")}else if(e=="padding"){n=t.clientWidth;r=t.clientHeight}else if(e=="border"){n=t.offsetWidth;r=t.offsetHeight}else if(e=="scroll"){n=t.scrollWidth;r=t.scrollHeight}else{n=t.offsetWidth;r=t.offsetHeight}return{width:n,height:r}},append:function(t,e){var r=this.isNode(e)?e:this.toNode(e);t.appendChild(r);return r},prepend:function(t,e){var r=this.isNode(e)?e:this.toNode(e);t.insertBefore(r,t.childNodes[0]);return r},after:function(t,e){var r=this.isNode(e)?e:this.toNode(e);t.parentNode.insertBefore(r,t.nextSibling);return r},before:function(t,e){var r=this.isNode(e)?e:this.toNode(e);t.parentNode.insertBefore(r,t);return r}};var w={whitespace:"[\\x20\\t\\r\\n\\f]"};function A(t,e){var r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t,null):t.currentStyle;return typeof e==="string"?r.getPropertyValue(e):r}function T(t){var e=document.getElementsByTagName("head")[0];e.style["color"]=t;var r=A(e,"color");var n=r.replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+w.whitespace));return[+n[0],+n[1],+n[2],n[3]==undefined?1:+n[3]]}var S=m(function(a){(function(){function e(t){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){e=function(t){return typeof t}}else{e=function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return e(t)}var r=Object.prototype.toString;function n(t){if(t==null){return t===undefined?"[object Undefined]":"[object Null]"}return r.call(t)}function t(t){return typeof t==="number"||t!==null&&e(t)==="object"&&n(t)==="[object Number]"}var o=t;var c={splitNum:function t(e,r){var n=Math.ceil(Math.PI*2/Math.asin(e/r)*2);return isNaN(n)||n<12?12:n}};function m(t,e,r,n,o){var i=Math.cos(r),a=Math.sin(r);return[(n-t)*i-(o-e)*a+t,(n-t)*a+(o-e)*i+e]}function l(t,e,r,n,o){var i=[t,e,r,t+n,e,r],a=Math.PI*2/o;for(var u=0;u<o;u++){var f=m(t,r,a*(u+1),t+n,r);i.push(f[0],e,f[1])}return i}function v(t,e,r,n,o,i){var a=[t+n,e,r,t+n,e+o,r],u=Math.PI*2/i;for(var f=0;f<i;f++){var s=m(t,r,u*(f+1),t+n,r);a.push(s[0],e,s[1],s[0],e+o,s[1])}return a}function p(t,e,r,n,o,i){var a=[t,e+n,r],u=Math.PI*2/o,f;for(var s=1;s<o*.5;s++){f=m(t,e,u*s,t,e+n);var c=m(t,r,u*i,f[0],r);a.push(c[0],f[1],c[1]);var l=m(t,r,u*(i+1),f[0],r);a.push(l[0],f[1],l[1])}a.push(t,e-n,r);return a}var i=function t(f){if(!o(f.precision)||f<=0){throw new Error("options.precision should be an integer greater than zero")}var s={cylinder:function t(e,r,n,o,i,a){var u=c.splitNum(f.precision,i);s.prism(e,r,n,o,i,a,u);return s},prism:function t(e,r,n,o,i,a,u){e({points:l(r,n,o,i,u),length:u+2,methods:"FanTriangle"});e({points:l(r,n+a,o,i,u),length:u+2,methods:"FanTriangle"});e({points:v(r,n,o,i,a,u),length:2*u+2,methods:"StripTriangle"});return s},sphere:function t(e,r,n,o,i){var a=c.splitNum(f.precision,i);for(var u=0;u<a;u++){e({points:p(r,n,o,i,a,u),length:a+1,methods:"StripTriangle"})}return s}};return s};if(e(a)==="object"&&e(a.exports)==="object"){a.exports=i}else{window.ThreeGeometry=i}})()});var x=function(){function n(t){o(this,n);i(this,"__core",void 0);i(this,"__geometry",void 0);i(this,"__light",void 0);i(this,"__camera",void 0);i(this,"__ThreeGeometry",void 0);this.__core=v(t.el);this.__core.shader("\n    attribute vec4 a_position;\n    uniform mat4 u_matrix;\n    void main(){\n        vec4 temp = u_matrix * a_position;\n\n        // 表示眼睛距离vec4(0.0,0.0,1.0)的距离\n        float dist = 2.0;\n\n        // 使用投影直接计算\n        // 此处要注意z轴承显示和实际的方向是相反的\n        gl_Position = vec4((dist + 1.0) * temp.x / (dist + temp.z), (dist + 1.0) * temp.y / (dist + temp.z), temp.z, 1.0);\n    }\n    ","\n    precision mediump float;\n    uniform vec4 u_color;\n    void main(){\n        gl_FragColor=u_color;\n    }\n    ");var e=_.size(t.el);this.__geometry=[];this.__ThreeGeometry=S({precision:Math.max(e.width,e.height)*.02});this.__light=[];this.__camera=b();var r=e.width>e.height?e.width:e.height;this.__camera.multiply([2/r,0,0,0,0,2/r,0,0,0,0,-2/r,0,0,0,0,1])}t(n,[{key:"geometry",value:function t(e){this.__geometry.push(e);var n=this.__geometry.length-1,o=this;return{setValue:function t(e){for(var r in e){o.__geometry[n][r]=e[r]}}}}},{key:"rotate",value:function t(e,r,n,o,i,a,u){this.__camera.rotate(-1*e,r,n,o,i,a,u);return this}},{key:"scale",value:function t(e,r,n,o,i,a){this.__camera.scale(e,r,n,o,i,a);return this}},{key:"move",value:function t(e,r,n,o){this.__camera.move(-1*e,r,n,o);return this}},{key:"draw",value:function t(){var e=this.__core.painter();var r=this.__core.buffer();e.openDeep();this.__core.setUniformMatrix4fv("u_matrix",this.__camera.value());var n=l(this.__geometry),o;try{for(n.s();!(o=n.n()).done;){var i;var a=o.value;var u=T(a.color);this.__core.setUniform4f("u_color",u[0]/255,u[1]/255,u[2]/255,u[3]);var f=[];switch(a.type){case"cylinder":{f=[a.x,a.y,a.z,a.radius,a.height];break}case"prism":{f=[a.x,a.y,a.z,a.radius,a.height,a.num];break}case"sphere":{f=[a.cx,a.cy,a.cz,a.radius];break}}(i=this.__ThreeGeometry)[a.type].apply(i,[function(t){r.write(new Float32Array(t.points)).use("a_position",3,3,0);if(t.methods=="StripTriangle"){e.stripTriangles(0,t.length)}else if(t.methods=="FanTriangle"){e.fanTriangles(0,t.length)}}].concat(s(f)))}}catch(t){n.e(t)}finally{n.f()}}}]);return n}();if((typeof module==="undefined"?"undefined":e(module))==="object"&&e(module.exports)==="object"){module.exports=x}else{window["Puly"]=x}})();